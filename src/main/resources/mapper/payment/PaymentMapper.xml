<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.plateer.ec1.payment.mapper.PaymentMapper">
    <select id="getOrderPayInfo" resultType="com.plateer.ec1.payment.vo.OrderPayInfoVO">
        select
            #{cnclReqAmt} as cnclReqAmt,
            od.*,
            py.*,
            og.goods_no,
            og.goods_nm,
            mb.mbr_no,
            mb.mbr_nm
        from op_ord_base od inner join op_pay_info py on od.ord_no = py.ord_no
                            inner join op_goods_info og on od.ord_no = og.ord_no
                            inner join et_mbr_base mb on od.mbr_no = mb.mbr_no
        where od.ord_no = #{ordNo}
          and (
                (pay_prgs_scd = '10' and pay_cmt_dtime is null) or
                (pay_prgs_scd = '20' and pay_cmt_dtime is not null)
            )
    </select>
</mapper>